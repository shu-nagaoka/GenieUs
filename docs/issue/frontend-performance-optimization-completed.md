# Frontend Performance Optimization - Phase 1 å®Œäº†å ±å‘Š

## ğŸ¯ Phase 1 å®Ÿè£…æ¦‚è¦

CSRã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã®ç¬¬1æ®µéšã¨ã—ã¦ã€React Queryå°å…¥ã¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ¡ãƒ¢åŒ–ã‚’å®Ÿè£…ã—ã¾ã—ãŸã€‚

## âœ… å®Œäº†å®Ÿè£…

### 1. React Query ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
- **Query Client**: ã‚«ã‚¹ã‚¿ãƒ è¨­å®šã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥ã‚’æœ€é©åŒ–
  - `staleTime`: 30åˆ†ï¼ˆCSRæœ€é©åŒ–ï¼‰
  - `gcTime`: 1æ™‚é–“ï¼ˆãƒ¡ãƒ¢ãƒªåŠ¹ç‡ï¼‰
  - 4xxç³»ã‚¨ãƒ©ãƒ¼ã®å†è©¦è¡Œåœæ­¢
  - ãƒ•ã‚©ãƒ¼ã‚«ã‚¹æ™‚è‡ªå‹•æ›´æ–°ç„¡åŠ¹åŒ–

- **Provider**: ã‚°ãƒ­ãƒ¼ãƒãƒ«çŠ¶æ…‹ç®¡ç†ã®çµ±åˆ
  - é–‹ç™ºç’°å¢ƒã§Devtoolsæœ‰åŠ¹åŒ–
  - ã‚¢ãƒ—ãƒªå…¨ä½“ã§ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥å…±æœ‰

### 2. APIæœ€é©åŒ–

#### Agents API
- **Hook**: `useAgents()` - ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆä¸€è¦§å–å¾—
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ™‚é–“**: 1æ™‚é–“ï¼ˆé™çš„ãƒ‡ãƒ¼ã‚¿ï¼‰
- **ãƒ¡ãƒ¢åŒ–**: ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚«ãƒ¼ãƒ‰ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- **ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯**: ã‚¨ãƒ©ãƒ¼æ™‚ã®placeholderData

#### Meal Plans API 
- **Hooks**: `useMealPlans()`, `useCreateMealPlan()`, `useDeleteMealPlan()`
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ™‚é–“**: 5åˆ†ï¼ˆå‹•çš„ãƒ‡ãƒ¼ã‚¿ï¼‰
- **æ¥½è¦³çš„æ›´æ–°**: å¤‰æ›´å¾Œã®è‡ªå‹•ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç„¡åŠ¹åŒ–
- **ãƒ‡ãƒ¼ã‚¿å¤‰æ›**: APIãƒ¬ã‚¹ãƒãƒ³ã‚¹â†’UIãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆãƒ¡ãƒ¢åŒ–ï¼‰

#### Effort Reports API
- **Hooks**: `useEffortRecords()`, `useEffortStats()`
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ™‚é–“**: 10åˆ†ï¼ˆè“„ç©ãƒ‡ãƒ¼ã‚¿ï¼‰
- **ä¸¦åˆ—å–å¾—**: è¨˜éŒ²ä¸€è¦§ã¨çµ±è¨ˆã®åŒæ™‚å–å¾—
- **ãƒ‡ãƒ¼ã‚¿å¤‰æ›**: ãƒ¡ãƒ¢åŒ–ã«ã‚ˆã‚‹åŠ¹ç‡åŒ–

#### ãã®ä»–API
- **Memories**: `useMemories()`, `useToggleMemoryFavorite()`
- **Schedules**: `useScheduleEvents()`

### 3. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæœ€é©åŒ–

#### ãƒ¡ãƒ¢åŒ–å®Ÿè£…
- **AgentCard**: React.memoé©ç”¨
- **ãƒ‡ãƒ¼ã‚¿å¤‰æ›**: useMemoé©ç”¨ï¼ˆè¨ˆç®—é‡ã®å¤šã„å‡¦ç†ï¼‰
- **APIå‘¼ã³å‡ºã—**: useCallbacké©ç”¨äºˆå®š

#### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- ã‚¨ãƒ©ãƒ¼å¢ƒç•Œã®å®Ÿè£…
- å†è©¦è¡Œãƒœã‚¿ãƒ³ã®è¿½åŠ 
- ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã®è¨­å®š

## ğŸ“Š æœŸå¾…ã•ã‚Œã‚‹æ€§èƒ½æ”¹å–„

### åˆå›ãƒ­ãƒ¼ãƒ‰æ™‚é–“
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥åŠ¹æœ**: 30-40%å‘ä¸Š
- **é‡è¤‡ãƒªã‚¯ã‚¨ã‚¹ãƒˆå‰Šé™¤**: ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è² è·è»½æ¸›
- **ä¸¦åˆ—ãƒ‡ãƒ¼ã‚¿å–å¾—**: ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°æ™‚é–“çŸ­ç¸®

### ãƒšãƒ¼ã‚¸é·ç§»æ™‚é–“  
- **ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆ**: 50-60%å‘ä¸Š
- **ãƒ¡ãƒ¢åŒ–åŠ¹æœ**: ä¸è¦ãªå†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°å‰Šé™¤
- **ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–**: ç¬é–“çš„ãªãƒšãƒ¼ã‚¸åˆ‡ã‚Šæ›¿ãˆ

### ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“
- **ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹**: ã‚¹ã‚±ãƒ«ãƒˆãƒ³UIæº–å‚™æ¸ˆã¿
- **ã‚¨ãƒ©ãƒ¼å‡¦ç†**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªå›å¾©æ©Ÿèƒ½
- **ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œ**: ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ‡ãƒ¼ã‚¿ã®æ´»ç”¨

## ğŸ”„ React Query ã®ä¸»ãªåŠ¹æœ

1. **è‡ªå‹•ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç®¡ç†**: æ‰‹å‹•çŠ¶æ…‹ç®¡ç†ã®å‰Šé™¤
2. **é‡è¤‡ãƒªã‚¯ã‚¨ã‚¹ãƒˆé˜²æ­¢**: åŒæ™‚APIå‘¼ã³å‡ºã—ã®çµ±åˆ
3. **ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰æ›´æ–°**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ°—ã¥ã‹ãªã„æ›´æ–°
4. **æ¥½è¦³çš„æ›´æ–°**: UIå³åº§åæ˜ â†’ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰åŒæœŸ
5. **ã‚¨ãƒ©ãƒ¼å¢ƒç•Œ**: å …ç‰¢æ€§ã®å‘ä¸Š

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å¤‰æ›´

### Before (å¾“æ¥)
```tsx
// æ‰‹å‹•çŠ¶æ…‹ç®¡ç†
const [data, setData] = useState([])
const [loading, setLoading] = useState(true)
const [error, setError] = useState(null)

useEffect(() => {
  fetchData().then(setData).catch(setError)
}, [])
```

### After (æœ€é©åŒ–å¾Œ)
```tsx
// React Query
const { data = [], isLoading, error } = useAgents()
// è‡ªå‹•ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã€é‡è¤‡é˜²æ­¢ã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
```

## ğŸ“‹ æ¬¡æœŸPhaseäºˆå®š

### Phase 2: UIæœ€é©åŒ–ï¼ˆå®Ÿè£…å¯èƒ½ï¼‰
- **Skeleton UI**: å…¨ãƒšãƒ¼ã‚¸é©ç”¨
- **Virtual Scrolling**: å¤§ãƒ‡ãƒ¼ã‚¿ãƒªã‚¹ãƒˆ
- **Lazy Loading**: ç”»åƒãƒ»ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- **Bundle Optimization**: å‹•çš„ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

### Phase 3: PWAæ©Ÿèƒ½ï¼ˆé•·æœŸè¨ˆç”»ï¼‰
- **Service Workers**: ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œ
- **Background Sync**: ãƒ‡ãƒ¼ã‚¿åŒæœŸ
- **Push Notifications**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šçŸ¥

## ğŸ› ï¸ æŠ€è¡“ä»•æ§˜

### ä¾å­˜é–¢ä¿‚
- `@tanstack/react-query`: ^5.66.9
- `@tanstack/react-query-devtools`: ^5.81.5

### ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ
```
src/
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useAgents.ts
â”‚   â”œâ”€â”€ useMealPlans.ts
â”‚   â”œâ”€â”€ useEffortReports.ts
â”‚   â”œâ”€â”€ useMemories.ts
â”‚   â””â”€â”€ useSchedules.ts
â”œâ”€â”€ libs/
â”‚   â””â”€â”€ query-client.ts
â””â”€â”€ components/
    â””â”€â”€ providers/
        â””â”€â”€ query-provider.tsx
```

## âœ… æ¤œè¨¼çµæœ

- **ãƒ“ãƒ«ãƒ‰æˆåŠŸ**: âœ… æœ€é©åŒ–ã‚³ãƒ¼ãƒ‰æ­£å¸¸å‹•ä½œ
- **å‹å®‰å…¨æ€§**: âœ… TypeScriptå®Œå…¨æº–æ‹ 
- **ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯é˜²æ­¢**: âœ… é©åˆ‡ãªã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
- **ã‚¨ãƒ©ãƒ¼å¢ƒç•Œ**: âœ… å …ç‰¢æ€§å‘ä¸Š

---

**Phase 1å®Œäº†**: React Query + ãƒ¡ãƒ¢åŒ–ã«ã‚ˆã‚‹åŸºç›¤æœ€é©åŒ–ãŒæ­£å¸¸ã«å®Ÿè£…ã•ã‚Œã€æ¬¡æ®µéšã®è©³ç´°UIæœ€é©åŒ–ã«ç§»è¡Œå¯èƒ½ã€‚